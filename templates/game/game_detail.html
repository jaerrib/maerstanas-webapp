{% extends "_base.html" %}
{% load static %}
{% load custom_filters %}

{% block title %}Game Detail{% endblock title %}

{% block content %}
<h1>Game Detail Placeholder</h1>
<h2>Players</h2>
<ul>
    <li>Game name: {{ game.name }}</li>
    <li>Player 1: {{ game.player1 }}</li>
    <li>Player 2: {{ game.player2 }}</li>
    <li>Special stones active? {{ game.using_special_stones }}</li>
    <li>Standard scoring (edges count)? {{ game.using_standard_scoring }}</li>
    <li>Score - Player 1: {{ game.score_p1 }}, Player 2: {{ game.score_p2 }}
    </li>
    <li>Active Player: {{ game.active_player }}</li>
    <li>Result: {{ game.result }}</li>
</ul>
<hr>
<div id="messageArea"></div>
{% if game.game_over %}
<a href="" role="button" class="btn btn-warning">Archive</a>
{% elif game.player2 is None %}
<a href="{% url 'game_delete' pk=game.id %}" role="button"
   class="btn btn-danger">Delete</a>
<a href="{% url 'game_update' pk=game.id %}" role="button"
   class="btn btn-warning">Edit</a>
{% else %}
<a href="{% url 'game_delete' pk=game.id %}" role="button"
   class="btn btn-danger">Abandon</a>
{% endif %}

{% block stone_selection %} {% include "stone_selection.html" %} {% endblock stone_selection %}

<div class="d-flex">
    <div class="square"></div>
    {% for letter in "ABCDEFG" %}
    <div class="square">{{letter}}</div>
    {% endfor %}
</div>
{% for row in 1|range_filter:8 %}
<div class="d-flex">
    <div class="square">{{row}}</div>
    {% for col in 1|range_filter:8 %}
    <a href="{% url 'process_move' pk=game.id stone=request.session.active_stone row=row col=col %}">
        <div class="square bg-secondary border border-secondary-subtle">
            {% with row_cells=game.gameboard.data|index:row %}
            {% with cell=row_cells|index:col %}
            <!-- cell.0 is the player number and cell.1 is the stone type -->
            {% if cell.0 == 1 and cell.1 == 1%}
            <img src="{% static 'images/dark_stone.svg' %}" class="stone"
                 alt="dark stone">
            {% elif cell.0 == 1 and cell.1 == 2 %}
            <img src="{% static 'images/dark_thunder_stone.svg' %}"
                 class="stone" alt="dark thunder stone">
            {% elif cell.0 == 1 and cell.1 == 3 %}
            <img src="{% static 'images/dark_woden_stone.svg' %}" class="stone"
                 alt="dark woden stone">
            {% elif cell.0 == 2 and cell.1 == 1 %}
            <img src="{% static 'images/light_stone.svg' %}" class="stone"
                 alt="light stone">
            {% elif cell.0 == 2 and cell.1 == 2 %}
            <img src="{% static 'images/light_thunder_stone.svg' %}"
                 class="stone"
                 alt="light thunder stone">
            {% elif cell.0 == 2 and cell.1 == 3 %}
            <img src="{% static 'images/light_woden_stone.svg' %}" class="stone"
                 alt="light woden stone">
            {% endif %}
            {% endwith %}
            {% endwith %}
        </div>
    </a>
    {% endfor %}
</div>
{% endfor %}
<hr>
<div id="moveList" class="overflow-auto form-control overflow-y-scroll"
     style="height: 24.5rem">
    {% if game.game_over %}
    <p class="fs-4 text-info fw-bold">GAME OVER</p>
    {% endif %}
    <p class="fs-4 my-1">Played Moves:</p>
    {% for move in game.played_moves_list.data reversed %}
    <p class="my-1"><span
            class="text-secondary">{{ forloop.revcounter }}.</span> {{ move }}
    </p>
    {% endfor %}
</div>
{% endblock content %}
